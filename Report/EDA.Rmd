---
title: "Exploratory Data Analysis"
author: "Elodie Kwan and Katia Voltz"
date: '2022-04-26'
output:
  pdf_document: default
  html_document:
    df_print: paged
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r echo=FALSE}
source(here::here("scripts/setup.R"))
```

In this section, we will proceed to an exploratory data analysis of the **German Credit data**. 

Let's start by importing the dataset. 
```{r}
German_credit <- read.csv("./../Data_DA/GermanCredit.csv", header = TRUE, sep = ";")
```


## Get to know the data 

### Title : german credit data 
### Name of the file : GermanCredit.cvs
### Abstract
The German Credit data has data on 1000 past credit applicants, described by 30 variables. Each applicant is rated as "Good" or "Bad" credit (encoded as 1 and 0 respectively in the response variable). 


**Goal** : We want to obtain a model that may be used to determine if new applicants present a good or bad credit risk

+ Number of instances : 1000
+ Number of attributes : 30
+ Attribute Information :

```{r}
str(German_credit)

summary(German_credit)
```

+ There are no missing values.
 
```{r}
which(is.na(German_credit))
```

+ The response variable is the '**Response**' variable - last column on the data. 
 
Response variable : credit rating is good
 
1. 0 : No

2. 1 : Yes


We have to make sure that the class of the variables are correct. As described above, all the variables are defined as *integer* but we know that we should have numerical and categorical variables in our dataset. Therefore, we have to transform the class of some of them.

```{r}
German_credit$DURATION <- as.numeric(German_credit$DURATION)
German_credit$AMOUNT <- as.numeric(German_credit$AMOUNT)
German_credit$INSTALL_RATE <- as.numeric(German_credit$INSTALL_RATE)
German_credit$AGE <- as.numeric(German_credit$AGE)
German_credit$NUM_CREDITS <- as.numeric(German_credit$NUM_CREDITS)
German_credit$NUM_DEPENDENTS <- as.numeric(German_credit$NUM_DEPENDENTS)

for (i in 1:ncol(German_credit)){
  if (class(German_credit[,i])=="integer"){
    German_credit[,i] <- factor(German_credit[,i])
    }
}

str(German_credit)
```

The binomial data are set as factors and the others as numerical. 

We can now describe the variables one more time and we should get better results.  

```{r}
describe(German_credit)
introduce(German_credit)

plot_intro(German_credit)
```

The plot helps us to see the percentage of contnuous variable, the percentage of discrete variables and whether or not some observations are missing. 


## Visualization of the data 
First, we plot all the continous variables into histograms and their corresponding density plots. 

```{r}
plot_histogram(German_credit)
plot_density(German_credit)
```

Our first notice is that the data are not really normally distributed. Some of them are right-tailed.

We can look at the tails and outliers more carefully through boxplots. 

```{r}
plot_boxplot(German_credit, by = 'RESPONSE',  ncol = 2,
             title = "Side-by-side boxplots")
```


Now, we can make some barplots of the categorical variables.

```{r}
for (i in 1:ncol(German_credit)){
  if (class(German_credit[,i])=="factor"){
    print(ggplot(German_credit) +
            geom_bar(aes(x=German_credit[,i]), fill = "coral") +
            ggtitle(paste("Barplot of", colnames(German_credit)[i])) +
            labs(x = paste(colnames(German_credit)[i])))
}}

```


From those barplots we can see: 

+ The majority of people do not check their account status. (CHK_ACCT)
+ Most people have an average balance of less than < 100 DM in their saving account (SAV_ACCT)
+ Most of the applicants has its own residence (OWN_RES)
+ Almost none of the applicants is a foreign worker (FOREIGN) 

A general summary can be done. 

```{r}
dfSummary(German_credit, style = 'grid')
```


### Correlation plot : 

Correlation plot between continuous variables : 
```{r}
plot_correlation(German_credit, type= 'c', cor_args = list( 'use' = 'complete.obs'))
```

There are little correlation between the continuous variables. We can notice that there is a correlation of 62% between the variable **DURATION** and **AMOOUNT**. 

Correlation plot between categorical variables : 
```{r}
plot_correlation(German_credit, type= 'd')
```

It is difficult to look at the correlation since there are a lot of variables on the graph. 
We can still see higher correlation between **RESPONSE 1**: 

+ and people that do not check their account (CHK_ACCT_3) 
+ and people that have a critical historical account (HISTORY_4)
+ and the variable _REAL_ESTATE_ (REAL_ESTATE)
+ and applicant that does not have their own property (PROP_UNKN_NONE_0)
+ and applicant that have their own residence (OWN_RES_1)

We can also see some correlation between **RESPONSE 0**: 

+ and people that have a checking account status < 0 DM (CHK_ACCT_0)
+ and people that have an average balance in savings account < 100 DM (SAV_ACCT_0)
+ and the variable _REAL_ESTATE_ (REAL_ESTATE)


